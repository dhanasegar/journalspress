{% extends 'base.html' %}
{% load static %}

{% block content %}

<!-- Hero Section -->
<section class="relative bg-gradient-to-r from-purple-600 to-indigo-800 py-20">
    <div class="container mx-auto px-6 text-center">
        <h1 class="text-4xl md:text-5xl font-bold text-white mb-6">New Submission</h1>
        <p class="text-xl text-purple-100 max-w-3xl mx-auto">Submit your research paper to Educore Journals</p>
    </div>
</section>
<div class="bg-gray-50 min-h-screen">
   
    <!-- Submission Form -->
    <div class="container mx-auto px-6 py-12">
        <form method="post" enctype="multipart/form-data" class="max-w-4xl mx-auto">
            {% csrf_token %}
            
            <!-- Progress Steps -->
            <div class="flex justify-between mb-12 relative">
                <div class="step-item active">
                    <div class="step-number">1</div>
                    <div class="step-label">Journal</div>
                </div>
                <div class="step-item active current">
                    <div class="step-number">2</div>
                    <div class="step-label">Author Info</div>
                </div>
                <div class="step-item">
                    <div class="step-number">3</div>
                    <div class="step-label">Title & Abstract</div>
                </div>
                <div class="step-item">
                    <div class="step-number">4</div>
                    <div class="step-label">Upload</div>
                </div>
            </div>

            <!-- Journal Selection -->
            <div class="bg-white rounded-xl shadow-md p-8 mb-8">
                <h2 class="text-xl font-bold text-gray-800 mb-6 flex items-center">
                    <i class="fas fa-book-open text-purple-600 mr-3"></i>
                    Journal Selection
                </h2>
                <div class="space-y-4">
                    <label class="block text-gray-700 mb-2">Select Journal*</label>
                    {{ paper_form.journal }}
                </div>
            </div>

            <!-- Author Information -->
            <div class="bg-white rounded-xl shadow-md p-8 mb-8" id="author-section">
                <h2 class="text-xl font-bold text-gray-800 mb-6 flex items-center">
                    <i class="fas fa-users text-purple-600 mr-3"></i>
                    Author Information
                </h2>
                <p class="text-gray-600 mb-6">
                    For each of the authors please fill out the form below. Some items on the form are explained here:
                </p>
                
                <div class="bg-purple-50 border-l-4 border-purple-500 p-4 mb-6">
                    <ul class="list-disc pl-5 space-y-2 text-gray-700">
                        <li>Email address will only be used for communication with the authors.</li>
                        <li>Web site can be used on the conference Web pages.</li>
                        <li>Each corresponding author will receive email messages from the system.</li>
                    </ul>
                </div>

                <!-- Author Forms Container -->
                <div id="author-forms-container">
                    {% for author_form in author_forms %}
                    <div class="author-form mb-8 border-b pb-8" id="author-{{ forloop.counter }}">
                        <h3 class="text-lg font-semibold text-gray-800 mb-4">Author {{ forloop.counter }}</h3>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <label class="block text-gray-700 mb-2">First name*</label>
                                {{ author_form.first_name }}
                            </div>
                            <div>
                                <label class="block text-gray-700 mb-2">Last name*</label>
                                {{ author_form.last_name }}
                            </div>
                            <div>
                                <label class="block text-gray-700 mb-2">Email*</label>
                                {{ author_form.email }}
                            </div>
                            <div>
                                <label class="block text-gray-700 mb-2">Phone Number*</label>
                                {{ author_form.phone_number }}
                            </div>
                            <div>
                                <label class="block text-gray-700 mb-2">Country*</label>
                                {{ author_form.country }}
                            </div>
                            <div>
                                <label class="block text-gray-700 mb-2">Organization*</label>
                                {{ author_form.organization }}
                            </div>
                            <div class="md:col-span-2">
                                <label class="block text-gray-700 mb-2">Web site</label>
                                {{ author_form.website }}
                            </div>
                            <div class="flex items-center">
                                {{ author_form.corresponding }}
                                <label class="ml-2 text-gray-700">Corresponding author</label>
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                </div>

                <!-- Add Author Button -->
                <button type="button" id="add-author-btn" class="flex items-center text-purple-600 font-medium hover:text-purple-800">
                    <i class="fas fa-plus-circle mr-2"></i>
                    Click here to add more authors
                </button>
            </div>

            <!-- Title & Abstract -->
            <div class="bg-white rounded-xl shadow-md p-8 mb-8">
                <h2 class="text-xl font-bold text-gray-800 mb-6 flex items-center">
                    <i class="fas fa-heading text-purple-600 mr-3"></i>
                    Title and Abstract
                </h2>
                <p class="text-gray-600 mb-6">
                    The title and the abstract should be entered as plain text, they should not contain HTML elements.
                </p>
                
                <div class="space-y-6">
                    <div>
                        <label class="block text-gray-700 mb-2">Title*</label>
                        {{ paper_form.title }}
                    </div>
                    <div>
                        <label class="block text-gray-700 mb-2">Abstract*</label>
                        {{ paper_form.abstract }}
                    </div>
                </div>
            </div>

            <!-- Keywords -->
            <div class="bg-white rounded-xl shadow-md p-8 mb-8">
                <h2 class="text-xl font-bold text-gray-800 mb-6 flex items-center">
                    <i class="fas fa-tags text-purple-600 mr-3"></i>
                    Keywords
                </h2>
                <p class="text-gray-600 mb-6">
                    Type a list of keywords (also known as key phrases or key terms), one per line to characterize your submission.
                </p>
                
                <div>
                    <label class="block text-gray-700 mb-2">Keywords* (one per line)</label>
                    {{ paper_form.keywords }}
                </div>
            </div>

            <!-- Uploads -->
            <div class="bg-white rounded-xl shadow-md p-8 mb-8">
                <h2 class="text-xl font-bold text-gray-800 mb-6 flex items-center">
                    <i class="fas fa-cloud-upload-alt text-purple-600 mr-3"></i>
                    Uploads
                </h2>
                
                <div class="space-y-6">
                    <div>
                        <label class="block text-gray-700 mb-2">Paper Upload*</label>
                        <p class="text-sm text-gray-500 mb-3">Upload your paper. The paper must be in DOC/PDF format (file extension .pdf, .doc, .docx)</p>
                        <div class="border-2 border-dashed border-gray-300 rounded-lg p-8 text-center">
                            <i class="fas fa-file-upload text-4xl text-gray-400 mb-3"></i>
                            <p class="text-gray-500 mb-3">Drag & drop your file here or click to browse</p>
                            {{ paper_form.paper_file }}
                            <p class="text-xs text-gray-500 mt-3">Maximum file size: 10MB</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Submission Button -->
            <div class="text-center">
                <button type="submit" class="px-8 py-4 bg-gradient-to-r from-purple-600 to-indigo-600 text-white font-semibold rounded-lg shadow-lg hover:shadow-xl transition-all duration-300 hover:scale-105">
                    Submit Paper
                    <i class="fas fa-paper-plane ml-2"></i>
                </button>
                <p class="text-gray-500 mt-4">
                    <i class="fas fa-info-circle text-purple-600 mr-1"></i>
                    Do not press the button twice: uploading may take time!
                </p>
            </div>
        </form>
    </div>
</div>

<!-- JavaScript for Dynamic Author Forms -->
<script>
document.addEventListener('DOMContentLoaded', function() {
    const authorFormsContainer = document.getElementById('author-forms-container');
    const addAuthorBtn = document.getElementById('add-author-btn');
    let authorCount = {{ author_forms|length }};

    addAuthorBtn.addEventListener('click', function() {
        authorCount++;
        
        // Create new author form HTML
        const newAuthorForm = document.createElement('div');
        newAuthorForm.className = 'author-form mb-8 border-b pb-8';
        newAuthorForm.id = `author-${authorCount}`;
        newAuthorForm.innerHTML = `
            <h3 class="text-lg font-semibold text-gray-800 mb-4">Author ${authorCount}</h3>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div>
                    <label class="block text-gray-700 mb-2">First name*</label>
                    <input type="text" name="author_${authorCount}_first_name" required 
                           class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:border-purple-500 focus:ring-1 focus:ring-purple-500">
                </div>
                <div>
                    <label class="block text-gray-700 mb-2">Last name*</label>
                    <input type="text" name="author_${authorCount}_last_name" required 
                           class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:border-purple-500 focus:ring-1 focus:ring-purple-500">
                </div>
                <div>
                    <label class="block text-gray-700 mb-2">Email*</label>
                    <input type="email" name="author_${authorCount}_email" required 
                           class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:border-purple-500 focus:ring-1 focus:ring-purple-500">
                </div>
                <div>
                    <label class="block text-gray-700 mb-2">Phone Number*</label>
                    <input type="tel" name="author_${authorCount}_phone_number" required 
                           class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:border-purple-500 focus:ring-1 focus:ring-purple-500">
                </div>
                <div>
                    <label class="block text-gray-700 mb-2">Country*</label>
                    <input type="text" name="author_${authorCount}_country" required 
                           class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:border-purple-500 focus:ring-1 focus:ring-purple-500">
                </div>
                <div>
                    <label class="block text-gray-700 mb-2">Organization*</label>
                    <input type="text" name="author_${authorCount}_organization" required 
                           class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:border-purple-500 focus:ring-1 focus:ring-purple-500">
                </div>
                <div class="md:col-span-2">
                    <label class="block text-gray-700 mb-2">Web site</label>
                    <input type="url" name="author_${authorCount}_website" 
                           class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:border-purple-500 focus:ring-1 focus:ring-purple-500">
                </div>
                <div class="flex items-center">
                    <input type="checkbox" name="author_${authorCount}_corresponding" 
                           class="h-5 w-5 text-purple-600 rounded border-gray-300 focus:ring-purple-500">
                    <label class="ml-2 text-gray-700">Corresponding author</label>
                </div>
            </div>
        `;
        
        // Insert the new form before the add button
        authorFormsContainer.appendChild(newAuthorForm);
        
        // Scroll to the new form
        newAuthorForm.scrollIntoView({ behavior: 'smooth' });
    });
});
</script>

<style>
    .step-item {
        display: flex;
        flex-direction: column;
        align-items: center;
        position: relative;
        flex: 1;
    }
    .step-item:not(:last-child):after {
        content: '';
        position: absolute;
        top: 20px;
        left: 50%;
        width: 100%;
        height: 2px;
        background-color: #e5e7eb;
        z-index: 0;
    }
    .step-item.active:not(:last-child):after {
        background-color: #8b5cf6;
    }
    .step-number {
        width: 40px;
        height: 40px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 9999px;
        border: 2px solid #e5e7eb;
        background-color: white;
        color: #9ca3af;
        font-weight: 600;
        position: relative;
        z-index: 10;
    }
    .step-item.active .step-number {
        border-color: #8b5cf6;
        background-color: #8b5cf6;
        color: white;
    }
    .step-item.current .step-number {
        box-shadow: 0 0 0 4px rgba(139, 92, 246, 0.2);
    }
    .step-label {
        margin-top: 8px;
        font-size: 14px;
        color: #6b7280;
    }
    .step-item.active .step-label {
        color: #8b5cf6;
        font-weight: 500;
    }
    
    select, input[type="text"], input[type="email"], input[type="tel"], input[type="url"], textarea {
        width: 100%;
        padding: 12px 16px;
        border-radius: 8px;
        border: 1px solid #d1d5db;
    }
    select:focus, input[type="text"]:focus, input[type="email"]:focus, 
    input[type="tel"]:focus, input[type="url"]:focus, textarea:focus {
        border-color: #8b5cf6;
        outline: none;
        box-shadow: 0 0 0 1px #8b5cf6;
    }
    
    .author-form {
        transition: all 0.3s ease;
    }
</style>
{% endblock %}